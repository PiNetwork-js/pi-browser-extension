(function(){"use strict";const c=/^(?:pi|https):\/\/app-cdn\.minepi\.com\/mobile-app-ui\/app\/(.*?)(?:$|\/)|^(?:(?:pi|https):\/\/|)(.*?)\.pinet\.com/,n={brainstorm:"brainstorm.pinet.com",kyc:"kyc.pinet.com",devportal:"develop.pinet.com",translate:"pi://translate.pi","platform-demo-app":"pi://demo.pi",ecosystem:"ecosystem.pinet.com",chat:"chat.pinet.com",fireside:"fireside.pinet.com",profiles:"profiles.pinet.com"},m=/^(?:pi|https):\/\/app-cdn\.minepi\.com\/mobile-app-ui\/(.*?)(?:\?.*|$|\/)|^(?:(?:pi|https):\/\/|)(.*?)\.pinet\.com/,a={home:"pinet.com",wallet:"wallet.pinet.com",feed:"mine.pinet.com",error:"pi://error.pi"};function g(t){const e=t.replace("https://","pi://");if(c.test(e)){const[,o,i]=c.exec(e)??[];return o in n?n[o]:i in n?n[i]:e}if(m.test(e)){const[,o,i]=m.exec(e)??[];return o in a?a[o]:i in n?n[i]:a.home}return e.startsWith("pi://blockexplorer.minepi.com/")||e.startsWith("pi://minepi.com/blockexplorer/")?"blockexplorer.minepi.com":e}function b(){const e=new URL(window.location.href).searchParams.get("url");return e?!e.startsWith("pi://")&&!e.startsWith("https://")?`https://${e}`:e.replace("pi://","https://"):`https://${a.home}`}async function N(t){const e=localStorage.getItem("mobile-app-webview-ui_access-token");if(!e)return t;let o;try{o=new URL(t).hostname}catch{return`https://app-cdn.minepi.com/mobile-app-ui/error?url=${encodeURIComponent(t)}`}const r=await(await fetch(`https://socialchain.app/api/mobile_app/resolved_url?q=${o}`,{headers:{Authorization:e}}).catch()).json();return r.redirect_url?r.redirect_url.replace("http://","https://")+new URL(t).pathname:t}function d(t,e="replace"){const o=t?g(t):"";switch(e){case"push":{window.history.pushState({},"",`/browser?url=${o}`);break}case"pop":{window.history.back();break}case"replace":{window.history.replaceState({},"",`/browser?url=${o}`);break}}}function v(t){const{body:e}=new DOMParser().parseFromString(t,"text/html"),o=[...e.children];return o.length===1?o[0]:o}var l=(t=>(t.INIT_NAVIGATION="@pi:browser:init-navigation",t.NAVIGATION_CHANGE="@pi:browser:navigation-change",t.UNKNOWN="unknown",t))(l||{});function y(t){const e=document.querySelector("iframe");e&&(e.src=t)}function I(t){t.addEventListener("load",()=>{t.contentWindow?.postMessage({type:l.INIT_NAVIGATION})}),window.addEventListener("message",e=>{e.data.type===l.NAVIGATION_CHANGE&&(e.data.payload.navigate&&y(e.data.payload.url),d(e.data.payload.url,e.data.payload.action))})}function k(t,e){const o=v(`<iframe src="${e}" allow="clipboard-read; clipboard-write; camera" style="width: 100vw; height: 100vh; border: none;"></iframe>`);I(o),t.append(o)}function S(t,e,o){const i=new MutationObserver((r,s)=>{for(const _ of r)e(_,s)});return i.observe(t,{childList:!0,subtree:!0,...o}),()=>i.disconnect()}function A(t,e=document.documentElement){return new Promise(o=>{S(e,(i,r)=>{const s=e.querySelector(t);s&&(r.disconnect(),o(s))})})}async function U(){const t=await A("#root"),e=b(),o=await N(e);k(t,o);const i=c.test(o)?e:o;d(i)}const u={platform:{desktop:!0,os:"win32",version:"10.0.0",arch:"x64",uuid:"",hostApp:"pi-node"},bundleData:{versionNumber:"1.11.0",buildNumber:"33"},nativeSupport:{requestPermission:!0,inlineMediaPlayback:!0}},p=structuredClone(u);p.platform.hostApp="pi-browser",p.platform.desktop=!1,p.platform.os="android";const f=p;function h(t){localStorage.setItem("@pi:webview_ui_behaviors",JSON.stringify(t)),window.location.reload()}function w(){const t=localStorage.getItem("@pi:webview_ui_behaviors"),e=localStorage.getItem("mobile-app-webview-ui_access-token"),o=localStorage.getItem("@pi:logged-in");e&&t!==JSON.stringify(f)?(h(f),window.location.reload()):!e&&!o&&(h(u),localStorage.setItem("@pi:logged-in","false"),window.location.href="https://app-cdn.minepi.com/mobile-app-ui/node-signin"),window.location.href!=="https://app-cdn.minepi.com/mobile-app-ui/node-signin"&&o==="false"&&(window.location.href="https://app-cdn.minepi.com/mobile-app-ui/node-signin"),e&&o==="false"&&(localStorage.setItem("@pi:logged-in","true"),window.location.href="https://app-cdn.minepi.com/browser"),window.location.href.startsWith("https://app-cdn.minepi.com/browser")&&U()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>w(),{once:!0}):w()})();
