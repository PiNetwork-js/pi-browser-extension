(function(){"use strict";function p(){const e={get:()=>"Mozilla/5.0 (Linux; Android 13) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.153 Mobile Safari/537.36 PiBrowser/1.7.1"},t={get:()=>"Google Inc."};try{Object.defineProperty(window.navigator,"userAgent",e),Object.defineProperty(window.navigator,"vendor",t)}catch{console.log("Failed to override user agent")}}function c(){window.open=e=>{if(!e)return window;const t=typeof e=="string"?e:e.toString();return window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:t}},"*"),window}}function d(){window.parent.postMessage({type:"@pi:browser:pi-app-check"},"*"),window.addEventListener("message",e=>{e.data.type==="@pi:browser:pi-app-detected"&&(p(),c())})}function w(e,t,n){const i=new MutationObserver((o,a)=>{for(const v of o)t(v,a)});return i.observe(e,{childList:!0,subtree:!0,...n}),()=>i.disconnect()}function l(e,t=document.documentElement){return new Promise(n=>{w(t,(i,o)=>{const a=t.querySelector(e);a&&(o.disconnect(),n(a))})})}async function s(){(await l("div[data-testid=app-list]")).children[4].addEventListener("click",()=>{window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:"https://blockexplorer.minepi.com/",navigate:!0}})})}function u(){window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/welcome/"&&window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:"https://app-cdn.minepi.com/mobile-app-ui/welcome/"}}),window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/app/ecosystem"&&window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:"https://app-cdn.minepi.com/mobile-app-ui/app/ecosystem"}})}async function f(e){const t=localStorage.getItem("mobile-app-webview-ui_access-token");if(!t)return e;const n=new URL(e).hostname,o=await(await fetch(`https://socialchain.app/api/mobile_app/resolved_url?q=${n}`,{headers:{Authorization:t}}).catch()).json();return o.redirect_url?o.redirect_url.replace("http://","https://")+new URL(e).pathname:e}function h(){const e=window.history.pushState;window.history.pushState=function(...i){Reflect.apply(e,this,i),window.dispatchEvent(new Event("locationchange"))};const t=window.history.replaceState;window.history.replaceState=function(...i){Reflect.apply(t,this,i),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})}let r=!1;function m(){window.addEventListener("message",e=>{let t;try{t=JSON.parse(e.data)}catch{t=e.data}t.type==="@pi:browser:init_navigation"&&(window.addEventListener("locationchange",()=>{window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/welcome/"&&s(),window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:window.location.href}})}),h()),t.type==="@pi:browser:navigation_change"&&(f(t.payload.url).then(n=>{window.location.href=n}),window.parent.postMessage(t)),t.type==="@pi:messaging:superposeDisplayUrl"&&(window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:t.payload.url,action:"push"}}),r=!0),t.type==="@pi:messaging:endSuperposeDisplayUrl"&&r&&(window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{action:"pop"}}),r=!1)})}function g(){window.origin==="https://app-cdn.minepi.com"&&(window.addEventListener("message",e=>{if(e.data.type==="@pi:browser:pi-app-detected"){document.querySelector("iframe")?.contentWindow?.postMessage({type:"@pi:browser:pi-app-detected"},"*");return}e.data.type==="@pi:browser:pi-app-check"&&window.parent.postMessage({type:"@pi:browser:pi-app-check"},"*")}),p(),m(),u(),window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/welcome/"&&s())}function y(){window.origin==="https://app-cdn.minepi.com"&&(p(),window.addEventListener("message",e=>{e.data.type==="@pi:browser:pi-app-check"&&document.querySelector("iframe")?.contentWindow?.postMessage({type:"@pi:browser:pi-app-detected"},"*")}))}async function b(){if(window.self===window.top){y();return}if(window.parent!==window.top){d();return}g()}b()})();
