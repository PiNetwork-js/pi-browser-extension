(function(){"use strict";function r(){const e={get:()=>"Mozilla/5.0 (Linux; Android 14) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6613.88 Mobile Safari/537.36 PiBrowser/1.11.0"},t={get:()=>"Google Inc."};try{Object.defineProperty(window.navigator,"userAgent",e),Object.defineProperty(window.navigator,"vendor",t)}catch{console.log("Failed to override user agent")}}var n=(e=>(e.INIT_NAVIGATION="@pi:browser:init-navigation",e.NAVIGATION_CHANGE="@pi:browser:navigation-change",e.PI_APP_CHECK="@pi:browser:pi-app-check",e.PI_APP_DETECTED="@pi:browser:pi-app-detected",e.SUPERPOSE_DISPLAY_URL="@pi:messaging:superposeDisplayUrl",e.END_SUPERPOSE_DISPLAY_URL="@pi:messaging:endSuperposeDisplayUrl",e.UNKNOWN="unknown",e))(n||{});function d(){window.open=e=>{if(!e)return window;const t=typeof e=="string"?e:e.toString();return window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{url:t}},"*"),window}}function w(){window.parent.postMessage({type:n.PI_APP_CHECK},"*"),window.addEventListener("message",e=>{e.data.type===n.PI_APP_DETECTED&&(r(),d())})}function l(e,t,o){const i=new MutationObserver((a,p)=>{for(const _ of a)t(_,p)});return i.observe(e,{childList:!0,subtree:!0,...o}),()=>i.disconnect()}function u(e,t=document.documentElement){return new Promise(o=>{l(t,(i,a)=>{const p=t.querySelector(e);p&&(a.disconnect(),o(p))})})}async function c(){(await u("div[data-testid=app-list]")).children[4].addEventListener("click",()=>{window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{url:"https://blockexplorer.minepi.com/",navigate:!0}})})}function f(){window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/home/"&&window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{url:"https://app-cdn.minepi.com/mobile-app-ui/home/"}}),window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/app/ecosystem"&&window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{url:"https://app-cdn.minepi.com/mobile-app-ui/app/ecosystem"}})}async function m(e){const t=localStorage.getItem("mobile-app-webview-ui_access-token");if(!t)return e;const o=new URL(e).hostname,a=await(await fetch(`https://socialchain.app/api/mobile_app/resolved_url?q=${o}`,{headers:{Authorization:t}}).catch()).json();return a.redirect_url?a.redirect_url.replace("http://","https://")+new URL(e).pathname:e}function h(){const e=window.history.pushState.bind(window.history);window.history.pushState=function(...i){Reflect.apply(e,this,i),window.dispatchEvent(new Event("locationchange"))};const t=window.history.replaceState.bind(window.history);window.history.replaceState=function(...i){Reflect.apply(t,this,i),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})}let s=!1;function E(){window.addEventListener("message",e=>{let t;try{t=JSON.parse(e.data)}catch{t=e.data}t.type===n.INIT_NAVIGATION&&(window.addEventListener("locationchange",()=>{window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/home/"&&c(),window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{url:window.location.href}})}),h()),t.type===n.NAVIGATION_CHANGE&&(m(t.payload.url).then(o=>{window.location.href=o}),window.parent.postMessage(t)),t.type===n.SUPERPOSE_DISPLAY_URL&&(window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{url:t.payload.url,action:"push"}}),s=!0),t.type===n.END_SUPERPOSE_DISPLAY_URL&&s&&(window.parent.postMessage({type:n.NAVIGATION_CHANGE,payload:{action:"pop"}}),s=!1)})}function A(){["https://app-cdn.minepi.com","https://blockexplorer.minepi.com"].includes(window.origin)&&(window.addEventListener("message",e=>{if(e.data.type===n.PI_APP_DETECTED){document.querySelector("iframe")?.contentWindow?.postMessage({type:n.PI_APP_DETECTED},"*");return}e.data.type===n.PI_APP_CHECK&&window.parent.postMessage({type:n.PI_APP_CHECK},"*")}),r(),E(),f(),window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/home/"&&c())}function P(){window.origin==="https://app-cdn.minepi.com"&&(r(),window.addEventListener("message",e=>{e.data.type===n.PI_APP_CHECK&&document.querySelector("iframe")?.contentWindow?.postMessage({type:n.PI_APP_DETECTED},"*")}))}function y(){if(window.self===window.top){P();return}if(window.parent!==window.top){w();return}A()}y()})();
