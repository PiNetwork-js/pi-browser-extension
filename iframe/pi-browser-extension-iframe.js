(function(){"use strict";function c(t,e,n){const o=new MutationObserver((i,a)=>{for(const y of i)e(y,a)});return o.observe(t,{childList:!0,subtree:!0,...n}),()=>o.disconnect()}function r(t,e=document.documentElement){return new Promise(n=>{c(e,(o,i)=>{const a=e.querySelector(t);a&&(i.disconnect(),n(a))})})}function d(){const t={get:()=>"Mozilla/5.0 (Linux; Android 13) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.153 Mobile Safari/537.36 PiBrowser/1.7.1"},e={get:()=>"Google Inc."};try{Object.defineProperty(window.navigator,"userAgent",t),Object.defineProperty(window.navigator,"vendor",e)}catch{console.log("Failed to override user agent")}}async function s(){(await r("div[data-testid=app-list]")).children[4].addEventListener("click",()=>{window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:"https://blockexplorer.minepi.com/",navigate:!0}})})}function w(){window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/welcome/"&&window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:"https://app-cdn.minepi.com/mobile-app-ui/welcome/"}}),window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/app/ecosystem"&&window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:"https://app-cdn.minepi.com/mobile-app-ui/app/ecosystem"}})}function l(){window.open=t=>{if(!t)return window;const e=typeof t=="string"?t:t.toString();return window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:e}},"*"),window}}function u(t){var e;(e=t.parentElement)==null||e.children[0].remove(),t.style.paddingLeft="0px"}async function h(t){const e=localStorage.getItem("mobile-app-webview-ui_access-token");if(!e)return t;const n=new URL(t).hostname,i=await(await fetch(`https://socialchain.app/api/mobile_app/resolved_url?q=${n}`,{headers:{Authorization:e}}).catch()).json();return i.redirect_url?i.redirect_url.replace("http://","https://")+new URL(t).pathname:t}function g(){const t=window.history.pushState;window.history.pushState=function(...o){Reflect.apply(t,this,o),window.dispatchEvent(new Event("locationchange"))};const e=window.history.replaceState;window.history.replaceState=function(...o){Reflect.apply(e,this,o),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))})}let p=!1;function f(){window.addEventListener("message",t=>{let e;try{e=JSON.parse(t.data)}catch{e=t.data}e.type==="@pi:browser:init_navigation"&&(window.addEventListener("locationchange",()=>{window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/welcome/"&&s(),window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:window.location.href}})}),g()),e.type==="@pi:browser:navigation_change"&&(h(e.payload.url).then(n=>{window.location.href=n}),window.parent.postMessage(e)),e.type==="@pi:messaging:superposeDisplayUrl"&&(window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{url:e.payload.url,action:"push"}}),p=!0),e.type==="@pi:messaging:endSuperposeDisplayUrl"&&p&&(window.parent.postMessage({type:"@pi:browser:navigation_change",payload:{action:"pop"}}),p=!1)})}async function m(){if(window.self===window.top)return;if(window.parent!==window.top){d(),l();return}if(window.origin!=="https://app-cdn.minepi.com")return;const t=await r("main");u(t),f(),w(),window.location.href==="https://app-cdn.minepi.com/mobile-app-ui/welcome/"&&s()}m()})();
